description: |
  git shallow clone instead of checkout.
  You can change depth and fetch_depth, but I do recommend set fetch_depth larger than 1.
  If you set fetch_depth 1, you will find build failed when new commit was pushed.
  fetch_depth default is 10 to cover re-build after several commit.
  Default github.com and bitbucket.org ssh key will not scan.
  # set fetch_depth: 1 to minimize fetch time
  - git/checkout_shallow:
      fetch_depth: 1
  # change depth:5 for some reason.
  - git/checkout_shallow:
      depth: 5
      fetch_depth: 5
  # set --shallow-since in clone_options
  - git/checkout_shallow:
      clone_options: '--shallow-since "5 days ago"'
  # set --depth and other options
  - git/checkout_shallow:
      clone_options: '--depth 1 --verbose'
  # set --shallow-since in fetch_options
  - git/checkout_shallow:
      clone_options: '--shallow-since "5 days ago"'
      fetch_options: '--shallow-since "5 days ago"'
  # set --depth and other options
  - git/checkout_shallow:
      fetch_options: '--depth 5 --verbose'
  # enable github ssh key scan
  - git/checkout_shallow:
      keyscan_github: true
  # enable bitbucket ssh key scan
  - git/checkout_shallow:
      keyscan_bitbucket: true
  # clone the repository to src
  - git/checkout_shallow:
      path: src

usage:
  version: 2.1

  orbs:
    git: guitarrapc/git-shallow-clone@x.y.z

  workflows:
    build:
      jobs:
        - git/checkout_shallow
